<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
    </head>
    <body>
        <h4 id=snum>00</h4>
        <form name="test">
            <input type="button" value="送信" id="button"><br>
            <input type="button" value="1x" onclick="speed=1000"><br>
            <input type="button" value="2x" onclick="speed=500"><br>
            <textarea id="a" name="txt" rows="10" cols="40"></textarea>
        </form>
        <div id="msb"></div>
        <div class=message></div>
    </body>

</html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script>
let message
let msg = []
let time
let speed = 1000;
let sec = -1
let resn = 0
$(function(){

    $.ajaxSetup({
        beforeSend: function(xhr){
            xhr.overrideMimeType("text/html;charset=Shift_JIS");
        }
    });
    $("#button").click(function() {
		
		const str1 = $('#a').val();
        let str2 = str1.slice(0,65).replace('test/read.cgi/livejupiter','livejupiter/dat')
        str2 += '.dat'
        $.get(str2, function(data){    
            let be = data.split('\n')
            for(i=0;i<be.length-1;i++){
                message = be[i].split('<>')
                clock = message[2].slice(11,-7).split(":")
                time=message[2].slice(17,-7) 
                msg.push({msg:'<p style="background-color:gray;padding:5px;color:white">'+(i+1)+message[0]+'　　　'+message[2]+'<br>'+message[3]+'</p>',num:clock,sec:time})                
            }
            hour = Number(msg[0].num[0])
            min = Number(msg[0].num[1])
            sec = Number(msg[0].num[2])-1
        });
        read()
	});

})
function read(){
    
    sec++
    window.setTimeout(read,speed)
    
    if(msg[resn].sec == ('00'+sec).slice(-2)){
        write()
        resn++
    }
    
    if(sec==60){
        sec=0
        min++
        if(min==60){
            min=0
            hour++
            if(hour==25){
                hour=0
            }
        }
    }
    document.getElementById('snum').innerText = (hour.toString()).slice(-2)+":"+(min.toString()).slice(-2)+":"+("00"+(sec).toString()).slice(-2);
}

function write(){
    document.getElementById('msb').insertAdjacentHTML('afterbegin',msg[resn].msg)
    if(msg[resn+1].num == ('00'+sec).slice(-2)){
        resn++
        write();
    }
}

document.getElementById('button').onclick = function(){
    console.log()
} 
 /* #read_text のテキストを data に変更 */
 
 
</script>