<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
    </head>
    <body>
        <form name="test">
            <input type="button" value="送信" id="button"><br>
            <input type="button" value="1x" onclick="speed=1000"><br>
            <input type="button" value="2x" onclick="speed=500"><br>
            <textarea id="a" name="txt" rows="10" cols="40"></textarea>
        </form>
        <div id="msb"></div>
    </body>

</html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script>
let message
let msg = []
let time
let speed = 1000;
let sec = 0
let resn = 0
$(function(){
    // Shift-JISに変更する場合
    $.ajaxSetup({
        beforeSend: function(xhr){
            xhr.overrideMimeType("text/html;charset=Shift_JIS");
        }
    });
    $("#button").click(function() {
		// 値を取得
		const str1 = $('#a').val();
        let str2 = str1.slice(0,65).replace('test/read.cgi/livejupiter','livejupiter/dat')
        str2 += '.dat'
        $.get(str2, function(data){    
            let be = data.split('\n')
            for(i=0;i<be.length-1;i++){
                message = be[i].split('<>')
                time=message[2].slice(17,-7)
                msg.push({msg:'<p style="background-color:gray;padding:5px;color:white">'+(i+1)+message[0]+'　　　'+message[2].slice(17,-6)+'<br>'+message[3]+'</p>',num:time})                
            }
            console.log(msg)
        });
        read()
	});

})
function read(){
    window.setTimeout(read,speed)
    console.log('a')
    if(msg[resn].num == ('00'+sec).slice(-2)){
        write()
        resn++
    }
    sec++
    
    console.log("秒"+sec+",レス番"+resn+",レス番秒"+msg[resn].num)
    
    
    if(sec==60){
        sec=00
    }
    
    
}

function write(){
    document.getElementById('msb').insertAdjacentHTML('afterbegin',msg[resn].msg)
    if(msg[resn+1].num == ('00'+sec).slice(-2)){
        resn++
        write();
    }
}

document.getElementById('button').onclick = function(){
    console.log()
} 
 /* #read_text のテキストを data に変更 */
 
 
</script>